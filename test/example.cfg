process PROD = {

//      service = Timing { }

//      service = SimpleMemoryCheck {
//              untracked int32 ignoreTotal = -1 # default is one
//      }

// source of MC events
include "HLTrigger/HLTexample/test/source.cfi"
replace FlatRandomPtGunSource.maxEvents = 1000

// fast simulation/reconstruction based on MC truth
include "HLTrigger/HLTexample/test/simrec.cfi"

// debug printout
//        service = MessageLogger {
//          untracked vstring destinations = {"cout"}
//          untracked PSet cout = { untracked string threshold = "DEBUG" }
//          untracked vstring debugModules = {"simrec","hlt3","hlt5","glob","anal3","anal5"}
//        }

//
// the following is not the most efficient configuration
// but allows to show the features possible, and how
// the trigger and timing reports are structured
//

// HLT filter modules

        module hlt1 = HLTSimpleJet {
                InputTag inputTag = simrec
                double   ptcut    = 50.0
                int32    njcut    = 1
        }

        module hlt2 = HLTFiltCand {
                InputTag photTag = simrec
                InputTag elecTag = simrec
                InputTag muonTag = simrec
                InputTag jetsTag = simrec
                InputTag metsTag = simrec
                double photPt  = 230.
                double elecPt  = 230.
                double muonPt  = 230.
                double jetsPt  = 230.
                double metsPt  = 230.
        }

	module hlt3 = HLT1CaloJet {
		InputTag inputTag = simrec
		double MinPt = 50.0
                double MaxEta= 9999.0
		int32  MinN = 1
	}

        module hlt4 = HLTDoublet {
                InputTag inputTag1 = hlt3
                InputTag inputTag2 = hlt3
                double MinDphi = 0.0
                double MaxDphi = 10.
                double MinDeta = -100.
                double MaxDeta = +100.
                double MinMinv = 100.
                double MaxMinv = 999.
                int32  MinN    = 1
	}

	module hlt5 = HLT1SmartCaloJet {
		InputTag inputTag = simrec
		string cut = "pt > 50.0 & -9999 < eta < 9999"
		int32  MinN = 1
	}

// Prescaler modules

        module presc1 = HLTPrescaler {
                bool   makeFilterObject = true
                uint32 prescaleFactor = 2
        }

        module presc2 = HLTPrescaler {
                bool   makeFilterObject = true
                uint32 prescaleFactor = 3
        }

        module presc3 = HLTPrescaler {
                bool   makeFilterObject = true
                uint32 prescaleFactor = 2
        }

        module presc4 = HLTPrescaler {
                bool   makeFilterObject = true
                uint32 prescaleFactor = 2
        }

        module presc5 = HLTPrescaler {
                bool   makeFilterObject = true
                uint32 prescaleFactor = 2
        }


// Actual trigger paths

        path p1 = {doSimRec, hlt1, presc1}
        path p2 = {doSimRec, hlt2, presc2} 
        path p3 = {doSimRec, hlt3, presc3} 
        path p4 = {doSimRec, hlt1, hlt4, presc4} 
        path p5 = {doSimRec, hlt5, presc5} 


// Final wrap-up analysis modules

//        module anal1 = HLTAnalFilt {
//            InputTag inputTag = hlt1
//        }

//        module anal2 = HLTAnalFilt {
//            InputTag inputTag = hlt2
//        }

//        module anal3 = HLTAnalFilt {
//            InputTag inputTag = hlt3
//        }

//        module anal4 = HLTAnalFilt {
//            InputTag inputTag = hlt4
//        }

//        module anal5 = HLTAnalFilt {
//            InputTag inputTag = hlt5
//        }

	module glob = HLTMakeSummaryObjects { }

        endpath end = {glob, out}
//        endpath end = {anal3, anal5, glob, out}

//      endpath end = {anal1, anal2, anal, glob, out}
//      module anal =  EventContentAnalyzer {}


// Want trigger table summary in log file & results object
// with specified triggers

        untracked PSet options = {
           untracked bool wantSummary = true  # default is false
           untracked bool makeTriggerResults = true 
           vstring listOfTriggers = {"p1","p2","p3","p4","p5"}
        }


// Writing out the data structures

        module out = PoolOutputModule {
          untracked string fileName = 'file:HLToutput.root'
          untracked PSet SelectEvents = {
          vstring SelectEvents = { "p1","p2","p3","p4","p5" }
          }
        }

}
